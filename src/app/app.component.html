<h1>Mapas de Conocimiento</h1>

<div class="main-layout">
  <div class="canvas-area">
    <div class="controls">
      <button (click)="onAddConcept()">Añadir Concepto</button>
      <!-- 
        Para el [disabled] del botón "Añadir Relación desde Seleccionado", 
        seguimos accediendo a las propiedades públicas de graphCanvas.
        Esto es para una respuesta visual inmediata del botón.
        Si esto sigue causando problemas, podríamos hacer que graphCanvas emita
        un booleano "isNodeSelected" o similar.
      -->
      <button (click)="onAddRelation()" [disabled]="!graphCanvas || !(graphCanvas.selectedElementId && graphCanvas.selectedElementType === 'node')">Añadir Relación desde Seleccionado</button>
      <button (click)="onAddRelationAny()">Añadir Relación (IDs)</button>
      <button (click)="onDeleteSelected()" [disabled]="!graphCanvas || !graphCanvas.selectedElementId">Eliminar Seleccionado</button>
      
      <!-- Usamos las propiedades de AppComponent (panelElementId) para la información en línea -->
      <div *ngIf="panelElementId" class="selected-info-inline">
        Seleccionado: {{ panelElementId }} ({{ panelElementType }})
      </div>
    </div>
    
    <!-- Escuchar el evento selectionChanged y llamar al manejador en AppComponent -->
    <app-graph-canvas #graphCanvasComponent (selectionChanged)="handleSelectionChange($event)"></app-graph-canvas>
  </div>

  <div class="sidebar-area">
    <!-- Pasar las propiedades de AppComponent al panel -->
    <app-properties-panel
      [elementId]="panelElementId"
      [elementType]="panelElementType">
    </app-properties-panel>
  </div>
</div>